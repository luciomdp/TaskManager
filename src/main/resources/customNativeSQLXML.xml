<list>
		<com.advenio.medere.dao.nativeSQL.SQLQueryConfig>
		<query>
			SELECT
				s.sector,
				s.name,
				s.description,
				COALESCE(sectormanager.name, '') AS sectormanagername,
				a.description AS area,
				count(employee._user) AS qtyspetialist,
				CASE
					WHEN CAST(count(employee._user) AS float) = 0 THEN 0   -- Para evitar la divisi√≥n por cero
					ELSE CAST((count(t.value) / count(employee._user)) AS float)*100  -- Factor de carga
				END AS loadfactor
			FROM sector AS s
			JOIN area AS a ON a.area = s.area
			LEFT JOIN _user AS sectormanager ON s.sectormanager = sectormanager._user
			LEFT JOIN _user AS employee ON s.sector = employee.sector AND employee.profile = 2 --Especialistas
			LEFT JOIN LATERAL (
				SELECT count(t.task) AS value
				FROM task AS t
				WHERE t.sector = s.sector AND t.state = 2 -- Estado por realizar
			) AS t ON 1 = 1
			GROUP BY s.sector, s.name, s.description, COALESCE(sectormanager.name, ''), a.description
		</query>
		<name>loadSectorDTOInfo</name>
		<classNameResult></classNameResult>
		<resultTransformerClass>com.advenio.medere.emr.dao.dto.SectorDTO
		</resultTransformerClass>
		<queryHasWhere>false</queryHasWhere>
		<queryReplaceParts />
	</com.advenio.medere.dao.nativeSQL.SQLQueryConfig>		

</list>